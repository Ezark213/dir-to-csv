# ディレクトリスキャナー

フォルダ構造をスキャンしてCSV形式で出力するツールです。

## 使い方

### 起動方法（2種類）

| 方法 | ファイル | 推奨 |
|------|---------|:----:|
| **バッチファイル版（推奨）** | `ディレクトリスキャナー.bat` | ○ |
| HTA版 | `ディレクトリスキャナー.hta` | - |

> **配布時はバッチファイル版を推奨します。** HTA版はダウンロード時のセキュリティ制限でエラーになる場合があります。

### 3ステップで完了

1. **フォルダを指定** - パスを入力するか「参照」ボタンで選択
2. **スキャン開始** - ボタンをクリック
3. **結果を確認** - CSVファイルが生成されます

## 対応するパス

| 種類 | 例 |
|------|-----|
| ローカルフォルダ | `C:\Users\...` |
| 社内サーバ | `\server\share` |
| Dropbox | `C:\Users\...\Dropbox\...` |
| OneDrive | `C:\Users\...\OneDrive\...` |
| 外付けHDD | `D:\...` |

## ファイル構成

### 必須ファイル（配布時に必要）

| ファイル | 説明 |
|---------|------|
| `ディレクトリスキャナー.bat` | ランチャー（これをダブルクリック） |
| `directory_scanner_gui.ps1` | GUI処理スクリプト |
| `directory_scanner.ps1` | スキャン処理スクリプト |

```
配布フォルダ/
├── ディレクトリスキャナー.bat      ← ダブルクリックで起動
├── directory_scanner_gui.ps1       ← GUI（自動で呼ばれる）
└── directory_scanner.ps1           ← スキャン処理（自動で呼ばれる）
```

### 自動生成されるファイル（配布不要）

| ファイル | 説明 | 削除可能 |
|---------|------|:--------:|
| `config.json` | 設定ファイル（毎回上書き） | ○ |
| `directory_structure.csv` | スキャン結果 | ○ |
| `error.log` | エラーログ | ○ |

## 出力形式（CSV）

```csv
level1,level2,level3,level4,level5,level6,level7,level8,filename,fullPath
営業部,2024年度,報告書,,,,,売上報告.xlsx,\server\営業部\2024年度\報告書\売上報告.xlsx
```

- 最大8階層まで対応
- Excelで開いても文字化けしません（BOM付きUTF-8）

## 詳細設定

| 項目 | 説明 | 初期値 |
|-----|------|-------|
| 最大階層数 | スキャンする深さ | 8 |
| 除外フォルダ | スキップするフォルダ名 | .git, node_modules等 |
| 出力ファイル名 | CSVファイルの名前 | directory_structure.csv |

## 動作環境

- Windows 10 / 11
- PowerShell 5.1以上（Windows標準搭載）
- 管理者権限は不要

## トラブルシューティング

### 「このシステムではスクリプトの実行が無効になっています」

PowerShellの実行ポリシーが制限されています。バッチファイルから起動すれば自動的にBypassされるため、通常は発生しません。

### HTA版でセキュリティエラーが出る

ダウンロードしたファイルにはWindowsのセキュリティ制限がかかります。
**バッチファイル版（`ディレクトリスキャナー.bat`）を使用してください。**

### アクセス拒否のフォルダがある

アクセス権限のないフォルダはスキップされ、`error.log`に記録されます。

## 注意事項

- アクセス権限のないフォルダはスキップされます
- 大量のファイルがある場合、処理に時間がかかることがあります
