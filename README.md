# ディレクトリスキャナー

フォルダ構造をスキャンしてCSV形式で出力するツールです。

## 使い方

### ダブルクリックで起動

`ディレクトリスキャナー.hta` をダブルクリックするだけ！

### 3ステップで完了

1. **フォルダを指定** - パスを入力するか「参照」ボタンで選択
2. **スキャン開始** - ボタンをクリック
3. **結果を確認** - CSVファイルが生成されます

## 対応するパス

| 種類 | 例 |
|------|-----|
| ローカルフォルダ | `C:\Users\...` |
| 社内サーバ | `\\server\share` |
| Dropbox | `C:\Users\...\Dropbox\...` |
| OneDrive | `C:\Users\...\OneDrive\...` |
| 外付けHDD | `D:\...` |

## ファイル構成

```
ディレクトリスキャナー/
├── ディレクトリスキャナー.hta  # アプリ本体（これをダブルクリック）
├── directory_scanner.ps1       # スキャン処理（必須）
└── README.md                   # このファイル
```

### 自動生成されるファイル

| ファイル | 説明 |
|---------|------|
| `config.json` | 設定ファイル（自動作成） |
| `directory_structure.csv` | スキャン結果 |
| `error.log` | エラーログ |

## 出力形式（CSV）

```csv
level1,level2,level3,level4,level5,level6,level7,level8,filename,fullPath
営業部,2024年度,報告書,,,,,売上報告.xlsx,\\server\営業部\2024年度\報告書\売上報告.xlsx
```

- 最大8階層まで対応
- Excelで開いても文字化けしません（BOM付きUTF-8）

## 詳細設定

アプリ画面の「詳細設定を表示」から設定できます：

| 項目 | 説明 | 初期値 |
|-----|------|-------|
| 最大階層数 | スキャンする深さ | 8 |
| 除外フォルダ | スキップするフォルダ名 | .git, node_modules等 |
| 出力ファイル名 | CSVファイルの名前 | directory_structure.csv |

## 配布方法

以下の2ファイルをセットで配布してください：

- `ディレクトリスキャナー.hta`
- `directory_scanner.ps1`

## 動作環境

- Windows 10 / 11
- 管理者権限は不要

## トラブルシューティング

### 「スクリプトの実行中にエラーが発生しました」と表示される

エラー画面にデバッグ情報が表示されます。以下を確認してください：

| 確認項目 | 対処法 |
|---------|--------|
| `appPath`が空または不完全 | HTAファイルを別の場所にコピーして実行 |
| `psPath`のファイルが存在しない | `directory_scanner.ps1`が同じフォルダにあるか確認 |
| ネットワークドライブから実行 | ローカルにコピーしてから実行 |

### SharePoint / OneDrive 同期フォルダから実行する場合

同期フォルダ内で実行するとパス取得に失敗することがあります。その場合：

1. フォルダごとローカル（例：`C:\Tools\ディレクトリスキャナ`）にコピー
2. コピー先から実行

### PowerShellスクリプトがブロックされる

ダウンロードしたファイルはWindowsにブロックされる場合があります：

1. `directory_scanner.ps1`を右クリック → プロパティ
2. 「ブロックの解除」にチェック → OK

## 注意事項

- アクセス権限のないフォルダはスキップされます
- 大量のファイルがある場合、処理に時間がかかることがあります
